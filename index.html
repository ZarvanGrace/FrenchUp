<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FrenchUp â€” Revision App</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0a0a;
    --bg2: #111111;
    --bg3: #1a1a1a;
    --bg4: #222222;
    --accent: #7c3aed;
    --accent2: #a855f7;
    --accent3: #c084fc;
    --glow: rgba(124,58,237,0.35);
    --green: #22c55e;
    --red: #ef4444;
    --gold: #f59e0b;
    --text: #f5f5f5;
    --text2: #a1a1aa;
    --text3: #71717a;
    --border: rgba(255,255,255,0.07);
    --border2: rgba(124,58,237,0.3);
    --card-shadow: 0 8px 32px rgba(0,0,0,0.6);
    --radius: 16px;
    --radius-sm: 10px;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  html, body {
    height: 100%;
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 15px;
    line-height: 1.6;
    overflow: hidden;
  }

  /* â”€â”€ NOISE TEXTURE â”€â”€ */
  body::before {
    content: '';
    position: fixed; inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.035'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 9999;
    opacity: 0.4;
  }

  /* â”€â”€ NAV (FIXED FOR MOBILE) â”€â”€ */
  nav {
    position: fixed;
    top: 0; left: 0; right: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 0 24px;
    height: 56px;
    background: rgba(10,10,10,0.9);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border);
    overflow-x: auto;
    overflow-y: hidden;
    -webkit-overflow-scrolling: touch;
  }
  
  nav::-webkit-scrollbar { height: 0; }

  .nav-logo {
    font-family: 'Syne', sans-serif;
    font-weight: 800;
    font-size: 18px;
    letter-spacing: -0.5px;
    color: var(--accent3);
    margin-right: 12px;
    text-shadow: 0 0 24px var(--glow);
    flex-shrink: 0;
  }

  nav .spacer { flex: 1; min-width: 8px; }

  .nav-btn {
    display: flex; align-items: center; gap: 6px;
    padding: 6px 14px;
    border-radius: 8px;
    border: none;
    background: transparent;
    color: var(--text2);
    font-family: 'DM Sans', sans-serif;
    font-size: 13.5px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    white-space: nowrap;
    flex-shrink: 0;
  }
  .nav-btn:hover { color: var(--text); background: var(--bg3); }
  .nav-btn.active {
    color: var(--accent3);
    background: rgba(124,58,237,0.15);
  }
  .nav-btn .icon { font-size: 16px; }

  /* â”€â”€ MUTE BUTTON (top right corner) â”€â”€ */
  #mute-btn {
    position: fixed;
    top: 64px;
    right: 16px;
    z-index: 200;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: var(--bg2);
    border: 1px solid var(--border);
    color: var(--text2);
    font-size: 18px;
    cursor: pointer;
    display: none;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    box-shadow: 0 4px 12px rgba(0,0,0,0.4);
  }
  #mute-btn:hover { background: var(--bg3); color: var(--text); transform: scale(1.05); }
  #mute-btn.active { color: var(--red); }

  /* â”€â”€ PAGES â”€â”€ */
  .page {
    position: fixed;
    inset: 56px 0 0 0;
    display: none;
    overflow: hidden;
  }
  .page.active { display: flex; flex-direction: column; }

  /* â”€â”€ PAGE HEADER â”€â”€ */
  .page-header {
    padding: 20px 28px 14px;
    flex-shrink: 0;
  }
  .page-header h1 {
    font-family: 'Syne', sans-serif;
    font-weight: 700;
    font-size: 22px;
    letter-spacing: -0.3px;
  }
  .page-header p { color: var(--text2); font-size: 13.5px; margin-top: 2px; }

  /* â”€â”€ SCROLL AREA â”€â”€ */
  .scroll-area {
    flex: 1;
    overflow-y: auto;
    padding: 0 28px 28px;
  }
  .scroll-area::-webkit-scrollbar { width: 4px; }
  .scroll-area::-webkit-scrollbar-track { background: transparent; }
  .scroll-area::-webkit-scrollbar-thumb { background: var(--bg4); border-radius: 4px; }

  /* â”€â”€ CARDS â”€â”€ */
  .card {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 20px;
    box-shadow: var(--card-shadow);
  }

  /* â”€â”€ BUTTONS â”€â”€ */
  .btn {
    display: inline-flex; align-items: center; justify-content: center; gap: 6px;
    padding: 9px 20px;
    border-radius: var(--radius-sm);
    border: none;
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    white-space: nowrap;
  }
  .btn-primary {
    background: var(--accent);
    color: white;
    box-shadow: 0 0 20px var(--glow);
  }
  .btn-primary:hover { background: var(--accent2); transform: translateY(-1px); box-shadow: 0 4px 24px var(--glow); }
  .btn-ghost {
    background: var(--bg3);
    color: var(--text2);
    border: 1px solid var(--border);
  }
  .btn-ghost:hover { background: var(--bg4); color: var(--text); }
  .btn-green { background: var(--green); color: white; }
  .btn-green:hover { filter: brightness(1.1); }
  .btn-red { background: var(--red); color: white; }
  .btn-red:hover { filter: brightness(1.1); }
  .btn-gold { background: var(--gold); color: #111; }
  .btn-gold:hover { filter: brightness(1.1); }
  .btn:disabled { opacity: 0.4; cursor: not-allowed; transform: none !important; }

  /* â”€â”€ TTS SPEAK BUTTON â”€â”€ */
  .speak-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    border-radius: 8px;
    background: var(--bg3);
    border: 1px solid var(--border);
    color: var(--accent3);
    font-size: 16px;
    cursor: pointer;
    transition: all 0.2s;
    flex-shrink: 0;
  }
  .speak-btn:hover { background: var(--bg4); transform: scale(1.05); }
  .speak-btn:active { transform: scale(0.95); }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     FLASHCARDS PAGE
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  #page-flash .content {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 20px;
    padding: 0 28px 28px;
    overflow: hidden;
  }

  /* pack selector overlay */
  #flash-pack-select {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 16px;
    text-align: center;
  }
  #flash-pack-select h2 { font-family: 'Syne', sans-serif; font-size: 20px; font-weight: 700; }
  #flash-pack-select p { color: var(--text2); font-size: 14px; max-width: 360px; }
  .pack-card {
    width: 300px;
    background: var(--bg2);
    border: 1px solid var(--border2);
    border-radius: var(--radius);
    padding: 20px;
    cursor: pointer;
    transition: all 0.2s;
    text-align: left;
  }
  .pack-card:hover { background: var(--bg3); border-color: var(--accent2); transform: translateY(-2px); box-shadow: 0 8px 24px var(--glow); }
  .pack-card .pack-name { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 16px; }
  .pack-card .pack-meta { color: var(--text2); font-size: 13px; margin-top: 4px; }
  .pack-card .pack-due { color: var(--accent3); font-size: 13px; margin-top: 6px; font-weight: 500; }

  /* flashcard study area */
  #flash-study { display: none; width: 100%; max-width: 480px; }
  #flash-study.visible { display: flex; flex-direction: column; align-items: center; gap: 16px; }

  .flash-progress {
    width: 100%;
    display: flex;
    align-items: center;
    gap: 12px;
    font-size: 13px;
    color: var(--text2);
  }
  .progress-bar-track {
    flex: 1;
    height: 4px;
    background: var(--bg4);
    border-radius: 99px;
    overflow: hidden;
  }
  .progress-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), var(--accent3));
    border-radius: 99px;
    transition: width 0.4s ease;
  }

  /* the flip card */
  .flip-container {
    width: 100%;
    height: 320px;
    perspective: 1200px;
    cursor: pointer;
    position: relative;
  }
  .flipper {
    width: 100%;
    height: 100%;
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.5s cubic-bezier(0.4, 0.0, 0.2, 1);
  }
  .flip-container.flipped .flipper { transform: rotateY(180deg); }

  .card-face {
    position: absolute; inset: 0;
    backface-visibility: hidden;
    background: var(--bg2);
    border: 1px solid var(--border2);
    border-radius: var(--radius);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 32px;
    box-shadow: var(--card-shadow);
  }
  .card-front { z-index: 2; }
  .card-back { transform: rotateY(180deg); background: var(--bg3); }

  .card-prompt {
    font-size: 13px;
    color: var(--text3);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  .card-word {
    font-family: 'Syne', sans-serif;
    font-weight: 700;
    font-size: 32px;
    text-align: center;
    line-height: 1.2;
  }
  .card-hint {
    margin-top: 8px;
    font-size: 14px;
    color: var(--text2);
    text-align: center;
  }

  .flash-actions {
    width: 100%;
    display: flex;
    gap: 12px;
  }
  .flash-actions .btn { flex: 1; }

  .flash-result {
    width: 100%;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
  }
  .flash-result h3 { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 20px; }
  .flash-result p { color: var(--text2); font-size: 14px; max-width: 320px; }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     QUIZ PAGE
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  #page-quiz .content {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 0 28px 28px;
  }

  #quiz-start {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    text-align: center;
    max-width: 400px;
  }
  #quiz-start h2 { font-family: 'Syne', sans-serif; font-size: 20px; font-weight: 700; }
  #quiz-start p { color: var(--text2); font-size: 14px; }
  .quiz-mode-card {
    width: 100%;
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 20px;
    cursor: pointer;
    transition: all 0.2s;
    text-align: left;
  }
  .quiz-mode-card:hover { background: var(--bg3); border-color: var(--accent2); transform: translateY(-2px); box-shadow: 0 8px 24px var(--glow); }
  .quiz-mode-card .mode-title { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 16px; }
  .quiz-mode-card .mode-desc { color: var(--text2); font-size: 13px; margin-top: 4px; }

  #quiz-game {
    display: none;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    width: 100%;
    max-width: 520px;
  }
  #quiz-game.visible { display: flex; }

  .quiz-header {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    font-size: 13px;
    color: var(--text2);
  }
  #quiz-type-tag {
    background: var(--bg3);
    padding: 4px 10px;
    border-radius: 6px;
    font-weight: 500;
  }

  #quiz-card {
    width: 100%;
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 28px;
    box-shadow: var(--card-shadow);
    transition: all 0.2s;
  }
  #quiz-card.pop { transform: scale(1.03); box-shadow: 0 0 32px var(--glow); }
  #quiz-card.shake { animation: shake 0.5s; }

  @keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-8px); }
    75% { transform: translateX(8px); }
  }

  #quiz-question {
    font-family: 'Syne', sans-serif;
    font-weight: 600;
    font-size: 18px;
    margin-bottom: 20px;
    text-align: center;
  }

  #quiz-answer-area {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  .quiz-option {
    padding: 14px 18px;
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: all 0.2s;
    font-size: 14.5px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .quiz-option:hover { background: var(--bg4); border-color: var(--accent3); }
  .quiz-option.correct { background: var(--green); color: white; border-color: var(--green); pointer-events: none; }
  .quiz-option.wrong { background: var(--red); color: white; border-color: var(--red); pointer-events: none; }
  .quiz-option.disabled { opacity: 0.5; pointer-events: none; }

  .fitb-input {
    width: 100%;
    padding: 14px 18px;
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 15px;
    margin-bottom: 12px;
  }
  .fitb-input:focus { outline: none; border-color: var(--accent3); }
  .fitb-input.correct { border-color: var(--green); background: rgba(34, 197, 94, 0.1); }
  .fitb-input.wrong { border-color: var(--red); background: rgba(239, 68, 68, 0.1); }

  .match-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
  }
  .match-col {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .match-item {
    padding: 12px 14px;
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: all 0.2s;
    font-size: 14px;
    text-align: center;
  }
  .match-item:hover { background: var(--bg4); border-color: var(--accent3); }
  .match-item.selected { background: var(--accent); color: white; border-color: var(--accent); }
  .match-item.matched-correct { background: var(--green); color: white; border-color: var(--green); pointer-events: none; }
  .match-item.matched-wrong { background: var(--red); color: white; border-color: var(--red); }

  .quiz-feedback {
    margin-top: 16px;
    padding: 10px 16px;
    border-radius: var(--radius-sm);
    font-size: 14px;
    font-weight: 500;
    text-align: center;
    display: none;
  }
  .quiz-feedback.correct { background: rgba(34, 197, 94, 0.15); color: var(--green); display: block; }
  .quiz-feedback.wrong { background: rgba(239, 68, 68, 0.15); color: var(--red); display: block; }

  #quiz-next-btn {
    margin-top: 16px;
    display: none;
  }

  #quiz-result {
    display: none;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    text-align: center;
    max-width: 400px;
  }
  #quiz-result.visible { display: flex; }

  .score-circle {
    width: 160px;
    height: 160px;
    border-radius: 50%;
    background: conic-gradient(var(--accent) calc(var(--pct) * 1%), var(--bg3) 0);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
  }
  .score-circle::before {
    content: '';
    position: absolute;
    inset: 10px;
    background: var(--bg);
    border-radius: 50%;
  }
  #score-num {
    position: relative;
    font-family: 'Syne', sans-serif;
    font-weight: 700;
    font-size: 32px;
    color: var(--text);
  }
  #result-title { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 24px; }
  #result-msg { color: var(--text2); font-size: 14px; max-width: 320px; }
  .result-actions { display: flex; gap: 12px; }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     VOCAB PAGE
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .vocab-controls {
    display: flex;
    gap: 12px;
    margin-bottom: 20px;
    flex-wrap: wrap;
  }
  .vocab-controls input {
    flex: 1;
    min-width: 180px;
    padding: 10px 16px;
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
  }
  .vocab-controls input:focus { outline: none; border-color: var(--accent3); }
  .vocab-controls button { flex-shrink: 0; }

  .vocab-table-wrap {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    overflow: hidden;
  }
  .vocab-table {
    width: 100%;
    border-collapse: collapse;
  }
  .vocab-table thead {
    background: var(--bg3);
    position: sticky;
    top: 0;
    z-index: 1;
  }
  .vocab-table th {
    padding: 14px 18px;
    text-align: left;
    font-weight: 600;
    font-size: 13px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text2);
    border-bottom: 1px solid var(--border);
  }
  .vocab-table td {
    padding: 14px 18px;
    border-bottom: 1px solid var(--border);
    font-size: 14.5px;
  }
  .vocab-table tr:last-child td { border-bottom: none; }
  .vocab-table tr:hover { background: var(--bg3); }

  .vocab-col-fr { 
    font-weight: 500; 
    color: var(--accent3);
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .vocab-col-en { color: var(--text2); }

  .vocab-pagination {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-top: 16px;
    gap: 12px;
    font-size: 13px;
    color: var(--text2);
    flex-wrap: wrap;
  }
  .vocab-pagination .btn { padding: 7px 16px; font-size: 13px; }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     GRAMMAR PAGE
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .grammar-toc {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 20px;
    margin-bottom: 24px;
  }
  .grammar-toc h3 { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 16px; margin-bottom: 12px; }
  .toc-list { list-style: none; }
  .toc-list li {
    padding: 8px 0;
    border-bottom: 1px solid var(--border);
  }
  .toc-list li:last-child { border-bottom: none; }
  .toc-list a {
    color: var(--accent3);
    text-decoration: none;
    font-size: 14px;
  }
  .toc-list a:hover { text-decoration: underline; }

  .grammar-section {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 24px;
    margin-bottom: 20px;
    scroll-margin-top: 80px;
  }
  .grammar-section h2 {
    font-family: 'Syne', sans-serif;
    font-weight: 700;
    font-size: 20px;
    margin-bottom: 16px;
    color: var(--accent3);
  }
  .grammar-section h3 {
    font-family: 'Syne', sans-serif;
    font-weight: 600;
    font-size: 17px;
    margin: 20px 0 12px;
  }
  .grammar-section p {
    color: var(--text2);
    font-size: 14.5px;
    margin-bottom: 12px;
    line-height: 1.7;
  }
  .grammar-section ul {
    margin: 12px 0 12px 24px;
    color: var(--text2);
    font-size: 14.5px;
  }
  .grammar-section li { margin-bottom: 6px; line-height: 1.6; }
  .grammar-section code {
    background: var(--bg3);
    padding: 2px 6px;
    border-radius: 4px;
    font-family: 'Courier New', monospace;
    font-size: 13.5px;
    color: var(--accent3);
  }
  .grammar-section .example {
    background: var(--bg3);
    border-left: 3px solid var(--accent);
    padding: 12px 16px;
    margin: 12px 0;
    border-radius: 6px;
  }
  .grammar-section .example p {
    margin-bottom: 6px;
    color: var(--text);
  }

  /* â”€â”€ RESPONSIVE â”€â”€ */
  @media (max-width: 600px) {
    nav { padding: 0 16px; gap: 6px; }
    .nav-logo { font-size: 16px; margin-right: 8px; }
    .nav-btn { padding: 6px 12px; font-size: 12.5px; }
    .page-header { padding: 16px 20px 12px; }
    .page-header h1 { font-size: 20px; }
    .scroll-area { padding: 0 20px 20px; }
    .card { padding: 16px; }
    .card-word { font-size: 28px; }
    #quiz-card { padding: 20px; }
    .match-grid { grid-template-columns: 1fr; }
    .vocab-table td, .vocab-table th { padding: 12px 14px; }
    .grammar-section { padding: 18px; }
  }
</style>
</head>
<body>

<!-- MUTE BUTTON (only visible on cards page) -->
<button id="mute-btn">ğŸ”Š</button>

<!-- NAV -->
<nav>
  <div class="nav-logo">FrenchUp</div>
  <div class="spacer"></div>
  <button class="nav-btn active" onclick="showPage('vocab')">
    <span class="icon">ğŸ“š</span> Vocab
  </button>
  <button class="nav-btn" onclick="showPage('quiz')">
    <span class="icon">ğŸ¯</span> Quiz
  </button>
  <button class="nav-btn" onclick="showPage('grammar')">
    <span class="icon">ğŸ“–</span> Grammar
  </button>
  <button class="nav-btn" onclick="showPage('flash')">
    <span class="icon">ğŸƒ</span> Cards
  </button>
</nav>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     VOCAB PAGE (NOW FIRST)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-vocab" class="page active">
  <div class="page-header">
    <h1>ğŸ“š Vocabulary List</h1>
    <p>Browse and search <span id="vocab-total">0</span> French words</p>
  </div>
  <div class="scroll-area">
    <div class="vocab-controls">
      <input type="text" id="vocab-search" placeholder="Search French or English..." oninput="vocabSearch()">
      <button class="btn btn-ghost" id="toggle-dir-btn" onclick="toggleDir()">ğŸ‡«ğŸ‡·â†’ğŸ‡¬ğŸ‡§</button>
    </div>
    <div class="vocab-table-wrap">
      <table class="vocab-table">
        <thead>
          <tr>
            <th id="th-col1">French</th>
            <th id="th-col2">English</th>
          </tr>
        </thead>
        <tbody id="vocab-tbody"></tbody>
      </table>
    </div>
    <div class="vocab-pagination">
      <span id="vocab-page-info"></span>
      <div style="display:flex;gap:8px;">
        <button class="btn btn-ghost" id="vocab-prev" onclick="vocabPrev()">â† Prev</button>
        <button class="btn btn-ghost" id="vocab-next" onclick="vocabNext()">Next â†’</button>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     QUIZ PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-quiz" class="page">
  <div class="page-header">
    <h1>ğŸ¯ Practice Quiz</h1>
    <p>Test your knowledge with different quiz modes</p>
  </div>
  <div class="content">
    <!-- Start Screen -->
    <div id="quiz-start">
      <h2>Choose Your Quiz Mode</h2>
      <p>Select one of the quiz types below to begin your practice session.</p>
      <div class="quiz-mode-card" onclick="startQuiz('mc')">
        <div class="mode-title">ğŸ² Multiple Choice</div>
        <div class="mode-desc">Choose the correct translation from 4 options</div>
      </div>
      <div class="quiz-mode-card" onclick="startQuiz('fitb')">
        <div class="mode-title">âœï¸ Fill in the Blank</div>
        <div class="mode-desc">Type the French translation yourself</div>
      </div>
      <div class="quiz-mode-card" onclick="startQuiz('match')">
        <div class="mode-title">ğŸ”— Match the Pairs</div>
        <div class="mode-desc">Connect French words with English meanings</div>
      </div>
    </div>

    <!-- Quiz Game -->
    <div id="quiz-game">
      <div class="quiz-header">
        <span id="quiz-type-tag">ğŸ² Multiple Choice</span>
        <span id="quiz-progress">Question 1/10</span>
        <span id="quiz-xp">âš¡ 0 XP</span>
      </div>
      <div id="quiz-card">
        <div id="quiz-question"></div>
        <div id="quiz-answer-area"></div>
        <div id="quiz-feedback" class="quiz-feedback"></div>
        <button id="quiz-next-btn" class="btn btn-primary" onclick="nextQuestion()">Next â†’</button>
      </div>
    </div>

    <!-- Result Screen -->
    <div id="quiz-result">
      <div class="score-circle" id="score-circle" style="--pct:0;">
        <span id="score-num">0/10</span>
      </div>
      <h3 id="result-title">Great work!</h3>
      <p id="result-msg">You're making progress. Keep it up!</p>
      <div class="result-actions">
        <button class="btn btn-ghost" onclick="goToStart()">â† Back</button>
        <button class="btn btn-primary" onclick="restartQuiz()">Try Again</button>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     GRAMMAR PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-grammar" class="page">
  <div class="page-header">
    <h1>ğŸ“– Grammar Guide</h1>
    <p>Master the fundamentals of French grammar</p>
  </div>
  <div class="scroll-area">
    <div class="grammar-toc">
      <h3>Quick Navigation</h3>
      <ul class="toc-list">
        <li><a href="#articles">Articles (le, la, les)</a></li>
        <li><a href="#gender">Noun Gender</a></li>
        <li><a href="#verbs">Verb Conjugation</a></li>
        <li><a href="#pronouns">Subject Pronouns</a></li>
        <li><a href="#negation">Negation (ne...pas)</a></li>
      </ul>
    </div>

    <section id="articles" class="grammar-section">
      <h2>Articles</h2>
      <p>French has definite (the) and indefinite (a/an) articles that must agree with the noun's gender and number.</p>
      <h3>Definite Articles</h3>
      <ul>
        <li><code>le</code> - masculine singular: <em>le chat</em> (the cat)</li>
        <li><code>la</code> - feminine singular: <em>la maison</em> (the house)</li>
        <li><code>les</code> - plural: <em>les chats</em> (the cats)</li>
        <li><code>l'</code> - before vowels: <em>l'ami</em> (the friend)</li>
      </ul>
      <div class="example">
        <p><strong>Example:</strong> <em>Le professeur parle Ã  la classe.</em></p>
        <p>(The teacher speaks to the class.)</p>
      </div>
    </section>

    <section id="gender" class="grammar-section">
      <h2>Noun Gender</h2>
      <p>All French nouns are either masculine or feminine. This affects articles, adjectives, and sometimes verb agreement.</p>
      <h3>Common Patterns</h3>
      <ul>
        <li>Words ending in <code>-tion</code>, <code>-sion</code>, <code>-tÃ©</code> are usually feminine</li>
        <li>Words ending in <code>-age</code>, <code>-ment</code> are usually masculine</li>
        <li>When in doubt, memorize the article with the noun!</li>
      </ul>
      <div class="example">
        <p><strong>Feminine:</strong> <em>la nation</em>, <em>la beautÃ©</em></p>
        <p><strong>Masculine:</strong> <em>le fromage</em>, <em>le gouvernement</em></p>
      </div>
    </section>

    <section id="verbs" class="grammar-section">
      <h2>Verb Conjugation</h2>
      <p>French verbs change form based on the subject. Here's the present tense of <code>parler</code> (to speak):</p>
      <ul>
        <li>je parle (I speak)</li>
        <li>tu parles (you speak - informal)</li>
        <li>il/elle parle (he/she speaks)</li>
        <li>nous parlons (we speak)</li>
        <li>vous parlez (you speak - formal/plural)</li>
        <li>ils/elles parlent (they speak)</li>
      </ul>
      <div class="example">
        <p><strong>Example:</strong> <em>Je parle franÃ§ais et tu parles anglais.</em></p>
        <p>(I speak French and you speak English.)</p>
      </div>
    </section>

    <section id="pronouns" class="grammar-section">
      <h2>Subject Pronouns</h2>
      <p>These pronouns are used as the subject of a sentence:</p>
      <ul>
        <li><code>je</code> - I</li>
        <li><code>tu</code> - you (informal singular)</li>
        <li><code>il</code> - he / <code>elle</code> - she</li>
        <li><code>nous</code> - we</li>
        <li><code>vous</code> - you (formal or plural)</li>
        <li><code>ils</code> - they (masculine) / <code>elles</code> - they (feminine)</li>
      </ul>
      <div class="example">
        <p><strong>Tip:</strong> Use <code>tu</code> with friends and family, <code>vous</code> with strangers or in formal settings.</p>
      </div>
    </section>

    <section id="negation" class="grammar-section">
      <h2>Negation</h2>
      <p>To make a sentence negative in French, place <code>ne</code> before the verb and <code>pas</code> after it.</p>
      <div class="example">
        <p><strong>Affirmative:</strong> <em>Je parle franÃ§ais.</em> (I speak French.)</p>
        <p><strong>Negative:</strong> <em>Je ne parle pas franÃ§ais.</em> (I don't speak French.)</p>
      </div>
      <p><strong>Note:</strong> In casual speech, <code>ne</code> is often dropped: <em>Je parle pas franÃ§ais.</em></p>
    </section>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     FLASHCARDS PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-flash" class="page">
  <div class="page-header">
    <h1>ğŸƒ Flashcards</h1>
    <p>Master vocabulary with spaced repetition</p>
  </div>
  <div class="content">
    <!-- Pack Selection -->
    <div id="flash-pack-select">
      <h2>Select a Pack</h2>
      <p>Choose a category to start reviewing flashcards.</p>
      <div class="pack-card" onclick="selectPack('all')">
        <div class="pack-name">ğŸŒ All Words</div>
        <div class="pack-meta">Complete vocabulary set</div>
        <div class="pack-due" id="pack-due-all">0 cards due</div>
      </div>
      <div class="pack-card" onclick="selectPack('basics')">
        <div class="pack-name">â­ Basics</div>
        <div class="pack-meta">Common greetings & essentials</div>
        <div class="pack-due" id="pack-due-basics">0 cards due</div>
      </div>
      <div class="pack-card" onclick="selectPack('verbs')">
        <div class="pack-name">ğŸƒ Action Verbs</div>
        <div class="pack-meta">Commonly used verbs</div>
        <div class="pack-due" id="pack-due-verbs">0 cards due</div>
      </div>
    </div>

    <!-- Study Area -->
    <div id="flash-study">
      <div class="flash-progress">
        <span id="flash-progress-text">Card 1/10</span>
        <div class="progress-bar-track">
          <div class="progress-bar-fill" id="flash-progress-bar" style="width:0%;"></div>
        </div>
      </div>

      <div class="flip-container" id="flip-container" onclick="flipCard()">
        <div class="flipper" id="flipper">
          <div class="card-face card-front">
            <div class="card-prompt">TRANSLATE TO ENGLISH</div>
            <div class="card-word" id="card-front-word">Bonjour</div>
            <div class="card-hint">Click to reveal</div>
          </div>
          <div class="card-face card-back">
            <div class="card-prompt">ENGLISH MEANING</div>
            <div class="card-word" id="card-back-word">Hello</div>
            <div class="card-hint">Click to continue</div>
          </div>
        </div>
      </div>

      <div class="flash-actions">
        <button class="btn btn-red" onclick="rateCard('again')">âŒ Again</button>
        <button class="btn btn-gold" onclick="rateCard('hard')">ğŸ”„ Hard</button>
        <button class="btn btn-green" onclick="rateCard('easy')">âœ… Easy</button>
      </div>
    </div>

    <!-- Session Complete -->
    <div id="flash-result" class="flash-result" style="display:none;">
      <h3>Session Complete! ğŸ‰</h3>
      <p id="flash-result-msg">You've reviewed all cards in this pack.</p>
      <button class="btn btn-primary" onclick="backToPacks()">â† Back to Packs</button>
    </div>
  </div>
</div>

<script>
// â”€â”€â”€ VOCAB DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const VOCAB = [
  { fr: "bonjour", en: "hello" },
  { fr: "au revoir", en: "goodbye" },
  { fr: "merci", en: "thank you" },
  { fr: "s'il vous plaÃ®t", en: "please" },
  { fr: "oui", en: "yes" },
  { fr: "non", en: "no" },
  { fr: "pardon", en: "excuse me" },
  { fr: "je ne comprends pas", en: "I don't understand" },
  { fr: "comment allez-vous?", en: "how are you?" },
  { fr: "trÃ¨s bien", en: "very good" },
  { fr: "un", en: "one" },
  { fr: "deux", en: "two" },
  { fr: "trois", en: "three" },
  { fr: "quatre", en: "four" },
  { fr: "cinq", en: "five" },
  { fr: "six", en: "six" },
  { fr: "sept", en: "seven" },
  { fr: "huit", en: "eight" },
  { fr: "neuf", en: "nine" },
  { fr: "dix", en: "ten" },
  { fr: "manger", en: "to eat" },
  { fr: "boire", en: "to drink" },
  { fr: "parler", en: "to speak" },
  { fr: "Ã©couter", en: "to listen" },
  { fr: "regarder", en: "to watch" },
  { fr: "lire", en: "to read" },
  { fr: "Ã©crire", en: "to write" },
  { fr: "dormir", en: "to sleep" },
  { fr: "courir", en: "to run" },
  { fr: "marcher", en: "to walk" },
  { fr: "maison", en: "house" },
  { fr: "chat", en: "cat" },
  { fr: "chien", en: "dog" },
  { fr: "livre", en: "book" },
  { fr: "table", en: "table" },
  { fr: "chaise", en: "chair" },
  { fr: "porte", en: "door" },
  { fr: "fenÃªtre", en: "window" },
  { fr: "voiture", en: "car" },
  { fr: "vÃ©lo", en: "bicycle" },
  { fr: "rouge", en: "red" },
  { fr: "bleu", en: "blue" },
  { fr: "vert", en: "green" },
  { fr: "jaune", en: "yellow" },
  { fr: "noir", en: "black" },
  { fr: "blanc", en: "white" },
  { fr: "grand", en: "big" },
  { fr: "petit", en: "small" },
  { fr: "beau", en: "beautiful" },
  { fr: "laid", en: "ugly" }
];

// â”€â”€â”€ TTS SETUP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let ttsEnabled = true;
let currentUtterance = null;

function speak(text) {
  if (!ttsEnabled) return;
  if (currentUtterance) {
    window.speechSynthesis.cancel();
  }
  currentUtterance = new SpeechSynthesisUtterance(text);
  currentUtterance.lang = 'fr-FR';
  currentUtterance.rate = 0.85;
  window.speechSynthesis.speak(currentUtterance);
}

function toggleMute() {
  ttsEnabled = !ttsEnabled;
  const btn = document.getElementById('mute-btn');
  btn.textContent = ttsEnabled ? 'ğŸ”Š' : 'ğŸ”‡';
  btn.classList.toggle('active', !ttsEnabled);
  if (!ttsEnabled && currentUtterance) {
    window.speechSynthesis.cancel();
  }
}

// â”€â”€â”€ PAGE NAVIGATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showPage(pageId) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('page-' + pageId).classList.add('active');
  document.querySelector(`.nav-btn[onclick="showPage('${pageId}')"]`).classList.add('active');
  
  // Show mute button only on cards page
  const muteBtn = document.getElementById('mute-btn');
  if (pageId === 'flash') {
    muteBtn.style.display = 'flex';
  } else {
    muteBtn.style.display = 'none';
    if (currentUtterance) {
      window.speechSynthesis.cancel();
    }
  }
}

// â”€â”€â”€ FLASHCARDS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let flashDeck = [];
let flashIdx = 0;
let flashFlipped = false;

function initFlash() {
  const allDue = VOCAB.length;
  const basicsDue = VOCAB.filter(w => ['bonjour','au revoir','merci','oui','non','pardon'].includes(w.fr)).length;
  const verbsDue = VOCAB.filter(w => w.en.startsWith('to ')).length;
  document.getElementById('pack-due-all').textContent = `${allDue} cards due`;
  document.getElementById('pack-due-basics').textContent = `${basicsDue} cards due`;
  document.getElementById('pack-due-verbs').textContent = `${verbsDue} cards due`;
}

function selectPack(pack) {
  if (pack === 'all') flashDeck = shuffle([...VOCAB]);
  else if (pack === 'basics') flashDeck = shuffle(VOCAB.filter(w => ['bonjour','au revoir','merci','s\'il vous plaÃ®t','oui','non','pardon','je ne comprends pas','comment allez-vous?','trÃ¨s bien'].includes(w.fr)));
  else if (pack === 'verbs') flashDeck = shuffle(VOCAB.filter(w => w.en.startsWith('to ')));
  flashIdx = 0;
  document.getElementById('flash-pack-select').style.display = 'none';
  document.getElementById('flash-study').classList.add('visible');
  document.getElementById('flash-result').style.display = 'none';
  loadCard();
}

function loadCard() {
  if (flashIdx >= flashDeck.length) {
    showFlashResult();
    return;
  }
  flashFlipped = false;
  const card = flashDeck[flashIdx];
  document.getElementById('card-front-word').textContent = card.fr;
  document.getElementById('card-back-word').textContent = card.en;
  document.getElementById('flip-container').classList.remove('flipped');
  document.getElementById('flash-progress-text').textContent = `Card ${flashIdx + 1}/${flashDeck.length}`;
  const pct = ((flashIdx + 1) / flashDeck.length) * 100;
  document.getElementById('flash-progress-bar').style.width = pct + '%';
  
  // Auto-play TTS for French word
  speak(card.fr);
}

function flipCard() {
  const container = document.getElementById('flip-container');
  if (!flashFlipped) {
    container.classList.add('flipped');
    flashFlipped = true;
  } else {
    // Allow flipping back to front
    container.classList.remove('flipped');
    flashFlipped = false;
  }
}

function rateCard(rating) {
  flashIdx++;
  loadCard();
}

function showFlashResult() {
  document.getElementById('flash-study').classList.remove('visible');
  const res = document.getElementById('flash-result');
  res.style.display = 'flex';
  document.getElementById('flash-result-msg').textContent = `You reviewed ${flashDeck.length} cards. Great work!`;
}

function backToPacks() {
  document.getElementById('flash-result').style.display = 'none';
  document.getElementById('flash-pack-select').style.display = 'flex';
  if (currentUtterance) {
    window.speechSynthesis.cancel();
  }
}

// â”€â”€â”€ QUIZ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let quizMode = 'mc';
let quizQuestions = [];
let quizIdx = 0;
let quizScore = 0;
let quizXP = 0;
let quizAnswered = false;

// Match mode state
let matchLeft = [];
let matchRight = [];
let matchCorrectMap = {};
let matchMatched = [];
let matchSelected = null;

function startQuiz(mode = 'mc') {
  quizMode = mode;
  quizIdx = 0;
  quizScore = 0;
  quizXP = 0;
  quizAnswered = false;
  quizQuestions = shuffle([...VOCAB]).slice(0, 10);
  document.getElementById('quiz-start').style.display = 'none';
  document.getElementById('quiz-game').classList.add('visible');
  document.getElementById('quiz-result').classList.remove('visible');
  renderQuestion();
}

function renderQuestion() {
  quizAnswered = false;
  document.getElementById('quiz-progress').textContent = `Question ${quizIdx + 1}/${quizQuestions.length}`;
  document.getElementById('quiz-feedback').className = 'quiz-feedback';
  document.getElementById('quiz-next-btn').style.display = 'none';
  if (quizMode === 'mc') renderMC();
  else if (quizMode === 'fitb') renderFITB();
  else if (quizMode === 'match') renderMatch();
}

function renderMC() {
  document.getElementById('quiz-type-tag').textContent = 'ğŸ² Multiple Choice';
  const q = quizQuestions[quizIdx];
  document.getElementById('quiz-question').textContent = `"${q.en}"`;
  
  // Add TTS button for the English phrase
  const qEl = document.getElementById('quiz-question');
  qEl.innerHTML = `"${q.en}" <button class="speak-btn" onclick="speak('${escStr(q.en)}'); event.stopPropagation();">ğŸ”Š</button>`;
  
  const wrong = shuffle(VOCAB.filter(w => w.fr !== q.fr)).slice(0, 3);
  const opts = shuffle([q, ...wrong]);
  const area = document.getElementById('quiz-answer-area');
  area.innerHTML = opts.map((o, i) => 
    `<div class="quiz-option" onclick="selectMC(${i}, '${escStr(o.fr)}', '${escStr(q.fr)}')">
      ${o.fr} 
      <button class="speak-btn" onclick="speak('${escStr(o.fr)}'); event.stopPropagation();">ğŸ”Š</button>
    </div>`
  ).join('');
}

function selectMC(idx, selected, correct) {
  if (quizAnswered) return;
  quizAnswered = true;
  const opts = document.querySelectorAll('.quiz-option');
  opts.forEach(o => o.classList.add('disabled'));
  if (selected === correct) {
    opts[idx].classList.add('correct');
    showFeedback(true);
  } else {
    opts[idx].classList.add('wrong');
    opts.forEach((o, i) => {
      if (o.textContent.trim().startsWith(correct)) {
        o.classList.add('correct');
      }
    });
    document.getElementById('quiz-card').classList.add('shake');
    setTimeout(() => document.getElementById('quiz-card').classList.remove('shake'), 500);
    showFeedback(false);
  }
  document.getElementById('quiz-next-btn').style.display = 'flex';
}

function renderFITB() {
  document.getElementById('quiz-type-tag').textContent = 'âœï¸ Fill in the Blank';
  const q = quizQuestions[quizIdx];
  const area = document.getElementById('quiz-answer-area');
  area.innerHTML = `
    <div style="margin-bottom:8px;font-family:'Syne',sans-serif;font-size:18px;color:var(--accent3);">
      "${q.en}" 
      <button class="speak-btn" onclick="speak('${escStr(q.en)}')">ğŸ”Š</button>
    </div>
    <input class="fitb-input" type="text" id="fitb-input" placeholder="Type in Frenchâ€¦" autocomplete="off">
    <button class="btn btn-primary" onclick="checkFITB()">Check</button>
  `;
  document.getElementById('fitb-input').onkeydown = e => { if (e.key === 'Enter') checkFITB(); };
  setTimeout(() => { const el = document.getElementById('fitb-input'); if (el) el.focus(); }, 50);
}

function checkFITB() {
  if (quizAnswered) return;
  const input = document.getElementById('fitb-input');
  if (!input) return;
  const val = input.value.trim();
  if (!val) return;
  const q = quizQuestions[quizIdx];
  const correct = q.fr.toLowerCase().replace(/[?!.,]/g,'').trim();
  const given = val.toLowerCase().replace(/[?!.,]/g,'').trim();
  quizAnswered = true;
  input.disabled = true;
  if (given === correct) {
    input.classList.add('correct');
    showFeedback(true);
    speak(q.fr);
  } else {
    input.classList.add('wrong');
    document.getElementById('quiz-card').classList.add('shake');
    setTimeout(() => document.getElementById('quiz-card').classList.remove('shake'), 500);
    showFeedback(false, 'Answer: ' + q.fr);
    speak(q.fr);
  }
  document.getElementById('quiz-next-btn').style.display = 'flex';
}

function renderMatch() {
  document.getElementById('quiz-type-tag').textContent = 'ğŸ”— Match the Pairs';
  document.getElementById('quiz-question').textContent = 'Match each French word to its English meaning.';

  const pairs = shuffle([...VOCAB]).slice(0, 5);
  matchLeft = pairs.map(p => p.fr);
  matchRight = shuffle(pairs.map(p => p.en));
  matchCorrectMap = {};
  pairs.forEach(p => { matchCorrectMap[p.fr] = p.en; });
  matchMatched = [];
  matchSelected = null;

  renderMatchUI();
}

function renderMatchUI() {
  const area = document.getElementById('quiz-answer-area');
  area.innerHTML = `<div class="match-grid">
    <div class="match-col" id="match-left">
      ${matchLeft.map((w, i) => {
        const done = matchMatched.some(m => m.fr === w);
        const cls = done ? 'match-item matched-correct' : 'match-item';
        return `<div class="${cls}" data-idx="${i}" data-side="left" onclick="matchClick(this)">
          ${w} 
          <button class="speak-btn" onclick="speak('${escStr(w)}'); event.stopPropagation();" style="margin-left:auto;">ğŸ”Š</button>
        </div>`;
      }).join('')}
    </div>
    <div class="match-col" id="match-right">
      ${matchRight.map((w, i) => {
        const done = matchMatched.some(m => m.en === w);
        const cls = done ? 'match-item matched-correct' : 'match-item';
        return `<div class="${cls}" data-idx="${i}" data-side="right" onclick="matchClick(this)">${w}</div>`;
      }).join('')}
    </div>
  </div>`;
}

function matchClick(el) {
  if (el.classList.contains('matched-correct')) return;
  if (matchSelected === null) {
    matchSelected = el;
    el.classList.add('selected');
    return;
  }
  const first = matchSelected;
  matchSelected = null;
  first.classList.remove('selected');

  let frWord, enWord, frEl, enEl;
  if (first.dataset.side === 'left' && el.dataset.side === 'right') {
    frWord = first.textContent.trim(); 
    enWord = el.textContent.trim(); 
    frEl = first; 
    enEl = el;
  } else if (first.dataset.side === 'right' && el.dataset.side === 'left') {
    frWord = el.textContent.trim(); 
    enWord = first.textContent.trim(); 
    frEl = el; 
    enEl = first;
  } else {
    el.classList.add('selected');
    matchSelected = el;
    return;
  }

  // Clean text for comparison (remove speaker button)
  frWord = frWord.split('ğŸ”Š')[0].trim();
  enWord = enWord.split('ğŸ”Š')[0].trim();

  if (matchCorrectMap[frWord] === enWord) {
    frEl.classList.add('matched-correct'); 
    enEl.classList.add('matched-correct');
    matchMatched.push({ fr: frWord, en: enWord });
    speak(frWord);
    if (matchMatched.length === matchLeft.length) {
      showFeedback(true, 'All pairs matched! ğŸ‰');
      quizAnswered = true;
      quizScore++;
      quizXP += 15;
      document.getElementById('quiz-xp').textContent = 'âš¡ ' + quizXP + ' XP';
      document.getElementById('quiz-next-btn').style.display = 'flex';
    }
  } else {
    frEl.classList.add('matched-wrong'); 
    enEl.classList.add('matched-wrong');
    setTimeout(() => { 
      frEl.classList.remove('matched-wrong'); 
      enEl.classList.remove('matched-wrong'); 
    }, 500);
  }
}

function showFeedback(correct, msg) {
  const fb = document.getElementById('quiz-feedback');
  if (correct && quizMode !== 'match') {
    quizScore++;
    quizXP += 10;
    document.getElementById('quiz-xp').textContent = 'âš¡ ' + quizXP + ' XP';
    fb.textContent = 'âœ… Correct! +10 XP';
    fb.className = 'quiz-feedback correct';
    document.getElementById('quiz-card').classList.add('pop');
    setTimeout(() => document.getElementById('quiz-card').classList.remove('pop'), 300);
  } else if (!correct) {
    fb.textContent = msg ? 'âŒ ' + msg : 'âŒ Wrong!';
    fb.className = 'quiz-feedback wrong';
  } else {
    fb.textContent = msg || 'âœ… All matched!';
    fb.className = 'quiz-feedback correct';
  }
}

function nextQuestion() {
  quizIdx++;
  if (quizIdx >= quizQuestions.length) {
    showQuizResult();
  } else {
    renderQuestion();
  }
}

function showQuizResult() {
  document.getElementById('quiz-game').classList.remove('visible');
  const res = document.getElementById('quiz-result');
  res.classList.add('visible');
  const pct = Math.round((quizScore / quizQuestions.length) * 100);
  document.getElementById('score-circle').style.setProperty('--pct', pct);
  document.getElementById('score-num').textContent = quizScore + '/' + quizQuestions.length;
  const msgs = [
    [0, 30, "Mon Dieuâ€¦ that was rough. Flip some cards first?"],
    [31, 60, "Not terrible. Could be worse. Could be better."],
    [61, 80, "Pretty decent! You're getting it."],
    [81, 99, "TrÃ¨s bien! You actually know this stuff!"],
    [100, 100, "Parfait! You absolute legend. ğŸ¥"]
  ];
  const m = msgs.find(([lo, hi]) => pct >= lo && pct <= hi);
  document.getElementById('result-title').textContent = pct >= 80 ? 'Impressive! ğŸ‰' : pct >= 50 ? 'Not bad!' : 'Rough session.';
  document.getElementById('result-msg').textContent = m[2];
}

function restartQuiz() {
  document.getElementById('quiz-result').classList.remove('visible');
  startQuiz(quizMode);
}

function goToStart() {
  document.getElementById('quiz-result').classList.remove('visible');
  document.getElementById('quiz-game').classList.remove('visible');
  document.getElementById('quiz-start').style.display = 'flex';
}

// â”€â”€â”€ VOCAB LIST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const ROWS_PER_PAGE = 15;
let vocabPage = 0;
let vocabDir = 'fr-en';
let vocabFiltered = [...VOCAB];

document.getElementById('vocab-total').textContent = VOCAB.length;

function vocabSearch() {
  const q = document.getElementById('vocab-search').value.toLowerCase();
  if (!q) { 
    vocabFiltered = [...VOCAB]; 
  } else {
    vocabFiltered = VOCAB.filter(w =>
      w.fr.toLowerCase().includes(q) || w.en.toLowerCase().includes(q)
    );
  }
  vocabPage = 0;
  renderVocab();
}

function toggleDir() {
  vocabDir = vocabDir === 'fr-en' ? 'en-fr' : 'fr-en';
  const btn = document.getElementById('toggle-dir-btn');
  btn.textContent = vocabDir === 'fr-en' ? 'ğŸ‡«ğŸ‡·â†’ğŸ‡¬ğŸ‡§' : 'ğŸ‡¬ğŸ‡§â†’ğŸ‡«ğŸ‡·';
  btn.classList.toggle('active-dir', vocabDir === 'en-fr');
  document.getElementById('th-col1').textContent = vocabDir === 'fr-en' ? 'French' : 'English';
  document.getElementById('th-col2').textContent = vocabDir === 'fr-en' ? 'English' : 'French';
  renderVocab();
}

function renderVocab() {
  const total = vocabFiltered.length;
  const totalPages = Math.max(1, Math.ceil(total / ROWS_PER_PAGE));
  if (vocabPage >= totalPages) vocabPage = totalPages - 1;
  const start = vocabPage * ROWS_PER_PAGE;
  const page = vocabFiltered.slice(start, start + ROWS_PER_PAGE);

  const tbody = document.getElementById('vocab-tbody');
  tbody.innerHTML = page.map(w => {
    const col1 = vocabDir === 'fr-en' ? w.fr : w.en;
    const col2 = vocabDir === 'fr-en' ? w.en : w.fr;
    const cls1 = vocabDir === 'fr-en' ? 'vocab-col-fr' : 'vocab-col-en';
    const cls2 = vocabDir === 'fr-en' ? 'vocab-col-en' : 'vocab-col-fr';
    
    // Add TTS button for French words
    if (vocabDir === 'fr-en') {
      return `<tr>
        <td class="${cls1}">
          <span>${col1}</span>
          <button class="speak-btn" onclick="speak('${escStr(col1)}')">ğŸ”Š</button>
        </td>
        <td class="${cls2}">${col2}</td>
      </tr>`;
    } else {
      return `<tr>
        <td class="${cls1}">${col1}</td>
        <td class="${cls2}">
          <span>${col2}</span>
          <button class="speak-btn" onclick="speak('${escStr(col2)}')">ğŸ”Š</button>
        </td>
      </tr>`;
    }
  }).join('');

  document.getElementById('vocab-page-info').textContent = `Page ${vocabPage + 1} of ${totalPages} (${total} entries)`;
  document.getElementById('vocab-prev').disabled = vocabPage === 0;
  document.getElementById('vocab-next').disabled = vocabPage >= totalPages - 1;
}

function vocabPrev() { 
  if (vocabPage > 0) { 
    vocabPage--; 
    renderVocab(); 
  } 
}

function vocabNext() {
  const totalPages = Math.ceil(vocabFiltered.length / ROWS_PER_PAGE);
  if (vocabPage < totalPages - 1) { 
    vocabPage++; 
    renderVocab(); 
  }
}

// â”€â”€â”€ UTILS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

function escStr(s) {
  return s.replace(/'/g, "\\'").replace(/"/g, '&quot;');
}

// â”€â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
initFlash();
renderVocab();

// Setup mute button
document.getElementById('mute-btn').onclick = toggleMute;
</script>
</body>
</html>
